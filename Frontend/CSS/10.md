# Chapter 10: Animations - In-Depth Explanation

## Introduction to CSS Animations

**CSS Animations** let you create complex, multi-step animations using keyframes. Unlike transitions (which animate between two states), animations can have multiple intermediate steps and run automatically.

**Animations vs Transitions:**
- **Transitions**: A → B (two states, triggered by state change)
- **Animations**: A → B → C → D... (multi-step, can run automatically)

**Key Components:**
1. `@keyframes` - Define the animation sequence
2. `animation-*` properties - Control how animation runs

---

## 10.1 @keyframes Rule

Defines the animation sequence with intermediate steps.

### Basic Syntax

```css
@keyframes animation-name {
    from {
        /* Starting styles */
    }
    to {
        /* Ending styles */
    }
}

/* OR with percentages */
@keyframes animation-name {
    0% {
        /* Starting styles */
    }
    50% {
        /* Midpoint styles */
    }
    100% {
        /* Ending styles */
    }
}
```

**Simple Example:**
```css
@keyframes fadeIn {
    from {
        opacity: 0;
    }
    to {
        opacity: 1;
    }
}

/* Same as: */
@keyframes fadeIn {
    0% {
        opacity: 0;
    }
    100% {
        opacity: 1;
    }
}
```

---

### Multi-step Animations

```css
@keyframes pulse {
    0% {
        transform: scale(1);
    }
    50% {
        transform: scale(1.1);
    }
    100% {
        transform: scale(1);
    }
}

/* Multiple properties at different times */
@keyframes slideAndFade {
    0% {
        opacity: 0;
        transform: translateX(-100px);
    }
    50% {
        opacity: 1;
    }
    100% {
        opacity: 1;
        transform: translateX(0);
    }
}

/* Complex sequence */
@keyframes colorChange {
    0% {
        background: red;
    }
    25% {
        background: yellow;
    }
    50% {
        background: green;
    }
    75% {
        background: blue;
    }
    100% {
        background: red;
    }
}
```

**Multiple Selectors at Same Step:**
```css
@keyframes bounce {
    0%, 100% {
        transform: translateY(0);
    }
    50% {
        transform: translateY(-30px);
    }
}
/* Start and end both at original position */
```

---

## 10.2 Animation Properties

### animation-name

Specifies which @keyframes to use.

```css
.element {
    animation-name: fadeIn;  /* Uses @keyframes fadeIn */
}

/* Multiple animations */
.element {
    animation-name: fadeIn, slideIn;
}

/* No animation */
.element {
    animation-name: none;
}
```

---

### animation-duration

How long one cycle takes.

```css
.element {
    animation-duration: 1s;      /* 1 second */
    animation-duration: 500ms;   /* 500 milliseconds */
    animation-duration: 0.5s;    /* 0.5 seconds */
}

/* Multiple animations, different durations */
.element {
    animation-name: fadeIn, rotate;
    animation-duration: 1s, 2s;
    /* fadeIn: 1s, rotate: 2s */
}
```

**Recommended Durations:**
- **Quick effects**: 200-300ms (UI feedback)
- **Normal animations**: 500ms-1s (most animations)
- **Slow animations**: 1-2s (attention-grabbing)
- **Background animations**: 3-10s (ambient effects)

---

### animation-timing-function

Controls acceleration curve. **Same as transition-timing-function.**

```css
.element {
    animation-timing-function: linear;      /* Constant speed */
    animation-timing-function: ease;        /* Default: slow-fast-slow */
    animation-timing-function: ease-in;     /* Accelerate */
    animation-timing-function: ease-out;    /* Decelerate */
    animation-timing-function: ease-in-out; /* Both */
}

/* Cubic bezier (custom) */
.element {
    animation-timing-function: cubic-bezier(0.42, 0, 0.58, 1);
}

/* Steps (discrete frames) */
.element {
    animation-timing-function: steps(5);       /* 5 equal steps */
    animation-timing-function: steps(5, end);  /* Jump at end of each step */
    animation-timing-function: steps(5, start); /* Jump at start */
    animation-timing-function: step-start;     /* Same as steps(1, start) */
    animation-timing-function: step-end;       /* Same as steps(1, end) */
}

/* Per-keyframe timing */
@keyframes custom {
    0% {
        animation-timing-function: ease-in;
        opacity: 0;
    }
    50% {
        animation-timing-function: ease-out;
        opacity: 1;
    }
    100% {
        opacity: 1;
    }
}
```

**Visual Comparison:**

```
linear:     ━━━━━━━━━━━━  (constant)

ease:       ╭━━━━━━━╮    (slow-fast-slow)

ease-in:    ╭━━━━━━━━    (accelerate)

ease-out:   ━━━━━━━━╮    (decelerate)

steps(4):   ▪━▪━▪━▪━     (discrete jumps)
```

---

### animation-delay

Wait before starting animation.

```css
.element {
    animation-delay: 0.5s;     /* Wait 0.5s */
    animation-delay: -0.5s;    /* Start 0.5s into animation */
}

/* Stagger animations */
.item:nth-child(1) { animation-delay: 0s; }
.item:nth-child(2) { animation-delay: 0.1s; }
.item:nth-child(3) { animation-delay: 0.2s; }
.item:nth-child(4) { animation-delay: 0.3s; }

/* Calculate delays dynamically */
.item {
    animation-delay: calc(var(--index) * 0.1s);
}
```

**Negative Delay:**
```css
/* Start animation 1s into sequence */
.element {
    animation-name: slideIn;
    animation-duration: 3s;
    animation-delay: -1s;  /* Starts at 1s mark, not 0s */
}
```

---

### animation-iteration-count

How many times animation runs.

```css
.element {
    animation-iteration-count: 1;        /* Once (default) */
    animation-iteration-count: 3;        /* 3 times */
    animation-iteration-count: infinite; /* Forever */
    animation-iteration-count: 2.5;      /* 2.5 times (stops mid-animation) */
}
```

**Examples:**
```css
/* Run once on page load */
.fade-in {
    animation-name: fadeIn;
    animation-iteration-count: 1;
}

/* Continuous pulse */
.pulse {
    animation-name: pulse;
    animation-iteration-count: infinite;
}

/* Loading indicator */
.spinner {
    animation-name: spin;
    animation-iteration-count: infinite;
}
```

---

### animation-direction

Controls playback direction.

```css
.element {
    animation-direction: normal;          /* Default: forwards */
    animation-direction: reverse;         /* Backwards */
    animation-direction: alternate;       /* Forward, then backward */
    animation-direction: alternate-reverse; /* Backward, then forward */
}
```

**Visual Explanation:**

**normal (default):**
```
Iteration 1: 0% → 100%
Iteration 2: 0% → 100%
Iteration 3: 0% → 100%
```

**reverse:**
```
Iteration 1: 100% → 0%
Iteration 2: 100% → 0%
Iteration 3: 100% → 0%
```

**alternate:**
```
Iteration 1: 0% → 100%
Iteration 2: 100% → 0%  ← Reverses
Iteration 3: 0% → 100%
```

**alternate-reverse:**
```
Iteration 1: 100% → 0%
Iteration 2: 0% → 100%  ← Reverses
Iteration 3: 100% → 0%
```

**Examples:**
```css
/* Smooth back-and-forth animation */
@keyframes swing {
    from { transform: rotate(-10deg); }
    to { transform: rotate(10deg); }
}

.pendulum {
    animation-name: swing;
    animation-duration: 1s;
    animation-iteration-count: infinite;
    animation-direction: alternate;  /* Swings smoothly */
}

/* Breathing effect */
@keyframes breathe {
    to { transform: scale(1.1); }
}

.breathing {
    animation: breathe 2s ease-in-out infinite alternate;
}
```

---

### animation-fill-mode

Controls styles before/after animation.

```css
.element {
    animation-fill-mode: none;      /* Default: no styles retained */
    animation-fill-mode: forwards;  /* Keep final state */
    animation-fill-mode: backwards; /* Apply first state before delay */
    animation-fill-mode: both;      /* Both forwards and backwards */
}
```

**Detailed Explanation:**

**none (default):**
```
Before animation: Original styles
During animation: Keyframe styles
After animation:  Original styles (reverts)
```

**forwards:**
```
Before animation: Original styles
During animation: Keyframe styles
After animation:  Final keyframe styles (retained!)
```

**backwards:**
```
Before animation: First keyframe styles (during delay)
During animation: Keyframe styles
After animation:  Original styles
```

**both:**
```
Before animation: First keyframe styles (during delay)
During animation: Keyframe styles
After animation:  Final keyframe styles (retained!)
```

**Examples:**
```css
/* Fade in and stay visible */
@keyframes fadeIn {
    from { opacity: 0; }
    to { opacity: 1; }
}

.element {
    opacity: 0;  /* Start invisible */
    animation: fadeIn 1s ease;
    animation-fill-mode: forwards;  /* Stay at opacity: 1 */
}

/* Apply starting style during delay */
@keyframes slideIn {
    from { transform: translateX(-100%); }
    to { transform: translateX(0); }
}

.element {
    animation: slideIn 1s ease 2s;  /* 2s delay */
    animation-fill-mode: backwards;  /* Start off-screen during delay */
}

/* Both: start off-screen during delay, stay in final position */
.element {
    animation-fill-mode: both;
}
```

---

### animation-play-state

Pause or resume animation.

```css
.element {
    animation-play-state: running;  /* Default: running */
    animation-play-state: paused;   /* Paused */
}

/* Control with interaction */
.element {
    animation: spin 2s linear infinite;
}

.element:hover {
    animation-play-state: paused;  /* Pause on hover */
}
```

**Use Cases:**
```css
/* Pause on hover */
.spinner:hover {
    animation-play-state: paused;
}

/* Toggle with JavaScript */
.element.paused {
    animation-play-state: paused;
}

/* Reduce motion accessibility */
@media (prefers-reduced-motion: reduce) {
    * {
        animation-play-state: paused !important;
    }
}
```

---

### animation Shorthand

Combines all animation properties.

```css
/* Shorthand syntax */
animation: name duration timing-function delay iteration-count direction fill-mode;

/* Full example */
.element {
    animation: fadeIn 1s ease 0.5s 1 normal forwards;
}

/* Multiple animations */
.element {
    animation: 
        fadeIn 1s ease forwards,
        slideIn 1s ease 0.5s forwards;
}

/* Longhand equivalent */
.element {
    animation-name: fadeIn;
    animation-duration: 1s;
    animation-timing-function: ease;
    animation-delay: 0.5s;
    animation-iteration-count: 1;
    animation-direction: normal;
    animation-fill-mode: forwards;
}
```

**Common Shorthand Patterns:**
```css
/* Simple fade in */
animation: fadeIn 0.5s ease;

/* Infinite spinner */
animation: spin 1s linear infinite;

/* Pulse effect */
animation: pulse 2s ease-in-out infinite alternate;

/* Run once and hold final state */
animation: slideIn 0.5s ease forwards;

/* Multiple animations */
animation: 
    fadeIn 0.5s ease,
    rotate 2s linear infinite;
```

---

## 10.2 Common Animation Patterns

### 1. Fade Animations

```css
/* Fade In */
@keyframes fadeIn {
    from {
        opacity: 0;
    }
    to {
        opacity: 1;
    }
}

/* Fade Out */
@keyframes fadeOut {
    from {
        opacity: 1;
    }
    to {
        opacity: 0;
    }
}

/* Fade In Up */
@keyframes fadeInUp {
    from {
        opacity: 0;
        transform: translateY(30px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

/* Fade In Down */
@keyframes fadeInDown {
    from {
        opacity: 0;
        transform: translateY(-30px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}
```

---

### 2. Slide Animations

```css
/* Slide In Left */
@keyframes slideInLeft {
    from {
        transform: translateX(-100%);
    }
    to {
        transform: translateX(0);
    }
}

/* Slide In Right */
@keyframes slideInRight {
    from {
        transform: translateX(100%);
    }
    to {
        transform: translateX(0);
    }
}

/* Slide Out */
@keyframes slideOut {
    from {
        transform: translateX(0);
        opacity: 1;
    }
    to {
        transform: translateX(100%);
        opacity: 0;
    }
}
```

---

### 3. Scale Animations

```css
/* Zoom In */
@keyframes zoomIn {
    from {
        transform: scale(0);
        opacity: 0;
    }
    to {
        transform: scale(1);
        opacity: 1;
    }
}

/* Pulse */
@keyframes pulse {
    0%, 100% {
        transform: scale(1);
    }
    50% {
        transform: scale(1.05);
    }
}

/* Heartbeat */
@keyframes heartbeat {
    0%, 100% {
        transform: scale(1);
    }
    10%, 30% {
        transform: scale(0.9);
    }
    20%, 40% {
        transform: scale(1.1);
    }
}
```

---

### 4. Rotation Animations

```css
/* Spin (continuous rotation) */
@keyframes spin {
    from {
        transform: rotate(0deg);
    }
    to {
        transform: rotate(360deg);
    }
}

/* Wobble */
@keyframes wobble {
    0%, 100% {
        transform: rotate(0deg);
    }
    25% {
        transform: rotate(-5deg);
    }
    75% {
        transform: rotate(5deg);
    }
}

/* Flip */
@keyframes flip {
    from {
        transform: perspective(400px) rotateY(0);
    }
    to {
        transform: perspective(400px) rotateY(360deg);
    }
}
```

---

### 5. Bounce Animations

```css
/* Simple Bounce */
@keyframes bounce {
    0%, 100% {
        transform: translateY(0);
    }
    50% {
        transform: translateY(-30px);
    }
}

/* Realistic Bounce (with easing) */
@keyframes bounceIn {
    0% {
        transform: scale(0.3);
        opacity: 0;
    }
    50% {
        transform: scale(1.05);
    }
    70% {
        transform: scale(0.9);
    }
    100% {
        transform: scale(1);
        opacity: 1;
    }
}

/* Bounce with multiple peaks */
@keyframes bounceAdvanced {
    0%, 20%, 50%, 80%, 100% {
        transform: translateY(0);
    }
    40% {
        transform: translateY(-30px);
    }
    60% {
        transform: translateY(-15px);
    }
}
```

---

### 6. Shake/Vibrate Animations

```css
/* Shake Horizontally */
@keyframes shake {
    0%, 100% {
        transform: translateX(0);
    }
    10%, 30%, 50%, 70%, 90% {
        transform: translateX(-10px);
    }
    20%, 40%, 60%, 80% {
        transform: translateX(10px);
    }
}

/* Vibrate */
@keyframes vibrate {
    0%, 100% {
        transform: translate(0, 0);
    }
    10%, 30%, 50%, 70%, 90% {
        transform: translate(-2px, 2px);
    }
    20%, 40%, 60%, 80% {
        transform: translate(2px, -2px);
    }
}
```

---

### 7. Loading Animations

```css
/* Spinner */
@keyframes spin {
    to {
        transform: rotate(360deg);
    }
}

.spinner {
    width: 40px;
    height: 40px;
    border: 4px solid rgba(0,0,0,0.1);
    border-left-color: #667eea;
    border-radius: 50%;
    animation: spin 1s linear infinite;
}

/* Dots */
@keyframes blink {
    0%, 60%, 100% {
        opacity: 0;
    }
    30% {
        opacity: 1;
    }
}

.dot {
    animation: blink 1.4s infinite;
}
.dot:nth-child(2) { animation-delay: 0.2s; }
.dot:nth-child(3) { animation-delay: 0.4s; }

/* Progress Bar */
@keyframes progress {
    from {
        width: 0%;
    }
    to {
        width: 100%;
    }
}

.progress-bar {
    animation: progress 2s ease-out forwards;
}
```

---

### 8. Attention Seekers

```css
/* Flash */
@keyframes flash {
    0%, 50%, 100% {
        opacity: 1;
    }
    25%, 75% {
        opacity: 0;
    }
}

/* Rubber Band */
@keyframes rubberBand {
    0%, 100% {
        transform: scale(1);
    }
    30% {
        transform: scaleX(1.25) scaleY(0.75);
    }
    40% {
        transform: scaleX(0.75) scaleY(1.25);
    }
    50% {
        transform: scaleX(1.15) scaleY(0.85);
    }
    65% {
        transform: scaleX(0.95) scaleY(1.05);
    }
    75% {
        transform: scaleX(1.05) scaleY(0.95);
    }
}

/* Tada */
@keyframes tada {
    0%, 100% {
        transform: scale(1) rotate(0deg);
    }
    10%, 20% {
        transform: scale(0.9) rotate(-3deg);
    }
    30%, 50%, 70%, 90% {
        transform: scale(1.1) rotate(3deg);
    }
    40%, 60%, 80% {
        transform: scale(1.1) rotate(-3deg);
    }
}
```

---

### 9. Skeleton Screen

```css
/* Shimmer effect for loading placeholders */
@keyframes shimmer {
    0% {
        background-position: -1000px 0;
    }
    100% {
        background-position: 1000px 0;
    }
}

.skeleton {
    background: linear-gradient(
        90deg,
        #f0f0f0 0px,
        #e0e0e0 40px,
        #f0f0f0 80px
    );
    background-size: 1000px 100%;
    animation: shimmer 2s infinite linear;
}
```

---

### 10. Typing Effect

```css
@keyframes typing {
    from {
        width: 0;
    }
    to {
        width: 100%;
    }
}

@keyframes blink {
    50% {
        border-color: transparent;
    }
}

.typewriter {
    overflow: hidden;
    border-right: 2px solid;
    white-space: nowrap;
    animation: 
        typing 3.5s steps(40) 1s forwards,
        blink 0.75s step-end infinite;
}
```

---

## 10.3 Performance Optimization

### Compositor-Only Properties

**GPU-Accelerated (✅ Animate These):**
- `transform` (all functions)
- `opacity`

**Avoid Animating (❌ Cause Reflow):**
- `width`, `height`
- `margin`, `padding`
- `top`, `left`, `right`, `bottom`
- `font-size`

**Why This Matters:**
```css
/* ❌ Poor performance (causes layout reflow) */
@keyframes expand {
    to { width: 200px; }
}

/* ✅ Good performance (compositor-only) */
@keyframes expand {
    to { transform: scaleX(2); }
}
```

---

### will-change Property

Hints browser about upcoming animations.

```css
/* Optimize specific property */
.element {
    will-change: transform;
}

/* Multiple properties */
.element {
    will-change: transform, opacity;
}

/* Auto (default) */
.element {
    will-change: auto;
}
```

**Best Practices:**
```css
/* ✅ Use on elements that will animate */
.animated-element {
    will-change: transform;
}

/* ✅ Remove after animation (via JavaScript) */
element.addEventListener('animationend', () => {
    element.style.willChange = 'auto';
});

/* ❌ Don't use on too many elements */
* {
    will-change: transform;  /* BAD! Wastes resources */
}

/* ❌ Don't use as permanent optimization */
.everything {
    will-change: transform;  /* Use temporarily! */
}
```

---

### Triggering Hardware Acceleration

```css
/* Force GPU layer creation */
.element {
    transform: translateZ(0);
    /* or */
    transform: translate3d(0, 0, 0);
}

/* With backface-visibility */
.element {
    backface-visibility: hidden;
    transform: translateZ(0);
}
```

---

## 10.4 Animation Best Practices

### 1. Accessibility - Reduced Motion

**Critical:** Respect user preference for reduced motion.

```css
/* Default: animations enabled */
.element {
    animation: bounce 1s ease infinite;
}

/* User prefers reduced motion */
@media (prefers-reduced-motion: reduce) {
    .element {
        animation: none;
    }
    
    /* Or minimal animation */
    .element {
        animation-duration: 0.01ms !important;
    }
}

/* Alternative: conditional animation */
@media (prefers-reduced-motion: no-preference) {
    .element {
        animation: bounce 1s ease infinite;
    }
}
```

---

### 2. Naming Conventions

```css
/* ✅ Descriptive names */
@keyframes fadeInUp { }
@keyframes slideOutLeft { }
@keyframes pulseGreen { }

/* ❌ Generic names */
@keyframes animation1 { }
@keyframes anim { }
```

---

### 3. Keep Animations Short

```css
/* ✅ Micro-interactions: 200-500ms */
animation: fadeIn 0.3s ease;

/* ✅ Attention: 500ms-1s */
animation: bounce 0.7s ease;

/* ✅ Background/ambient: 3-10s */
animation: float 8s ease-in-out infinite;

/* ❌ Too long (feels sluggish) */
animation: fadeIn 5s ease;
```

---

### 4. Use transform and opacity

```css
/* ✅ GPU-accelerated */
@keyframes slide {
    from { transform: translateX(-100%); }
    to { transform: translateX(0); }
}

/* ❌ Causes reflow */
@keyframes slide {
    from { left: -100%; }
    to { left: 0; }
}
```

---

## Interview Key Points

**Most Common Questions:**

**1. "Explain @keyframes syntax"**
```css
@keyframes name {
    from { /* or 0% */ }
    to { /* or 100% */ }
}
```

**2. "Animation vs Transition?"**
- Transition: Two states (A → B), triggered by state change
- Animation: Multi-step, can run automatically, more control

**3. "What's animation-fill-mode?"**
- none: Revert to original (default)
- forwards: Keep final state
- backwards: Apply first state during delay
- both: Both forwards and backwards

**4. "Explain animation-direction values"**
- normal: Forward every time
- reverse: Backward every time
- alternate: Forward, then backward, then forward...
- alternate-reverse: Backward, then forward, then backward...

**5. "How to make infinite animation?"**
```css
animation-iteration-count: infinite;
```

**6. "Best properties to animate for performance?"**
- transform (all functions) ✅
- opacity ✅
- Avoid: width, height, margin, top, left ❌

**7. "What's the animation shorthand order?"**
```css
animation: name duration timing-function delay iteration-count direction fill-mode;
```

**8. "How to pause animation?"**
```css
animation-play-state: paused;
```

**9. "Accessibility for animations?"**
```css
@media (prefers-reduced-motion: reduce) {
    * { animation: none !important; }
}
```

---

## Common Interview Animations

### 1. Loading Spinner

```css
@keyframes spin {
    to { transform: rotate(360deg); }
}

.spinner {
    width: 40px;
    height: 40px;
    border: 4px solid #f0f0f0;
    border-top-color: #667eea;
    border-radius: 50%;
    animation: spin 1s linear infinite;
}
```

### 2. Fade In on Page Load

```css
@keyframes fadeIn {
    from { opacity: 0; }
    to { opacity: 1; }
}

.content {
    animation: fadeIn 0.5s ease;
}
```

### 3. Bounce Effect

```css
@keyframes bounce {
    0%, 20%, 50%, 80%, 100% {
        transform: translateY(0);
    }
    40% {
        transform: translateY(-30px);
    }
    60% {
        transform: translateY(-15px);
    }
}

.bounce {
    animation: bounce 2s ease;
}
```

### 4. Pulse (Attention)

```css
@keyframes pulse {
    0%, 100% {
        transform: scale(1);
    }
    50% {
        transform: scale(1.1);
    }
}

.pulse {
    animation: pulse 2s ease-in-out infinite;
}
```

### 5. Slide In

```css
@keyframes slideIn {
    from {
        transform: translateX(-100%);
        opacity: 0;
    }
    to {
        transform: translateX(0);
        opacity: 1;
    }
}

.slide-in {
    animation: slideIn 0.5s ease forwards;
}
```

---

## Practice Exercises

1. Create a loading spinner animation
2. Build a fade-in-up animation for page load
3. Make a pulse animation for notification badge
4. Create a shake animation for error messages
5. Build a typing effect animation
6. Make a skeleton loading screen with shimmer
7. Create a continuous floating animation
8. Build a heartbeat animation
9. Make a bounce-in animation
10. Create a slide-in navigation menu

---

## Animation Libraries Reference

While you should know how to write animations from scratch, these libraries are common in production:

**Popular Libraries:**
- Animate.css - Pre-built animations
- GreenSock (GSAP) - JavaScript animation library
- Framer Motion - React animations
- Anime.js - Lightweight JavaScript animations

**Interview Tip:** Know the fundamentals, but mention you're familiar with libraries!