# Chapter 20: System Design Framework

> **Goal**: Master a systematic approach to system design interviews and real-world architecture

---

## 20.1 The RESHADED Framework

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  THE RESHADED FRAMEWORK                      â”‚
â”‚                                                              â”‚
â”‚  A systematic approach to any system design problem.        â”‚
â”‚  Use this in interviews AND real-world architecture.        â”‚
â”‚                                                              â”‚
â”‚  R - REQUIREMENTS                                           â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                          â”‚
â”‚  Clarify functional and non-functional requirements.        â”‚
â”‚  What does the system do? What are the constraints?         â”‚
â”‚                                                              â”‚
â”‚  E - ESTIMATION                                             â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                            â”‚
â”‚  Back-of-envelope calculations.                             â”‚
â”‚  How much data? How many requests? Storage needs?           â”‚
â”‚                                                              â”‚
â”‚  S - STORAGE SCHEMA                                         â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                          â”‚
â”‚  Data model design.                                         â”‚
â”‚  What entities? What relationships? SQL vs NoSQL?           â”‚
â”‚                                                              â”‚
â”‚  H - HIGH-LEVEL DESIGN                                      â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                        â”‚
â”‚  Component diagram.                                         â”‚
â”‚  What services? How do they interact?                       â”‚
â”‚                                                              â”‚
â”‚  A - API DESIGN                                             â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                             â”‚
â”‚  Endpoints and contracts.                                   â”‚
â”‚  What APIs does the system expose?                          â”‚
â”‚                                                              â”‚
â”‚  D - DETAILED DESIGN                                        â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                        â”‚
â”‚  Deep dive into 2-3 components.                             â”‚
â”‚  How does the core algorithm work?                          â”‚
â”‚                                                              â”‚
â”‚  E - EVALUATE                                               â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                               â”‚
â”‚  Trade-offs and bottlenecks.                                â”‚
â”‚  What are the limitations? Alternatives?                    â”‚
â”‚                                                              â”‚
â”‚  D - DISTINCTIVE                                            â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                             â”‚
â”‚  Scaling, reliability, edge cases.                          â”‚
â”‚  What makes this design robust?                             â”‚
â”‚                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 20.2 Requirements Gathering

### 20.2.1 Functional Requirements

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            FUNCTIONAL REQUIREMENTS                           â”‚
â”‚                                                              â”‚
â”‚  Questions to Ask:                                          â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                          â”‚
â”‚                                                              â”‚
â”‚  1. CORE FEATURES                                           â”‚
â”‚     "What are the main things users can do?"                â”‚
â”‚     - Create, Read, Update, Delete what?                    â”‚
â”‚     - What's the primary user flow?                         â”‚
â”‚                                                              â”‚
â”‚  2. USERS                                                   â”‚
â”‚     "Who are the users?"                                    â”‚
â”‚     - End users? Internal tools? APIs?                      â”‚
â”‚     - Different user types with different permissions?      â”‚
â”‚                                                              â”‚
â”‚  3. INPUT/OUTPUT                                            â”‚
â”‚     "What goes in and what comes out?"                      â”‚
â”‚     - File uploads? Real-time data?                         â”‚
â”‚     - Reports? Notifications?                               â”‚
â”‚                                                              â”‚
â”‚  4. SCOPE                                                   â”‚
â”‚     "What's in scope and out of scope?"                     â”‚
â”‚     - MVP features vs nice-to-haves                         â”‚
â”‚     - What can we ignore for now?                           â”‚
â”‚                                                              â”‚
â”‚                                                              â”‚
â”‚  Example: Design Twitter                                    â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                     â”‚
â”‚  âœ“ Post tweets (up to 280 chars)                           â”‚
â”‚  âœ“ Follow/unfollow users                                    â”‚
â”‚  âœ“ Home timeline (tweets from followed users)               â”‚
â”‚  âœ“ User timeline (tweets from one user)                     â”‚
â”‚  âœ— Direct messages (out of scope)                           â”‚
â”‚  âœ— Trending topics (out of scope)                           â”‚
â”‚  âœ— Ads system (out of scope)                                â”‚
â”‚                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 20.2.2 Non-Functional Requirements

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          NON-FUNCTIONAL REQUIREMENTS                         â”‚
â”‚                                                              â”‚
â”‚  These define HOW the system should perform.                â”‚
â”‚                                                              â”‚
â”‚                                                              â”‚
â”‚  1. SCALE                                                   â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                  â”‚
â”‚  - How many users? (100? 1M? 1B?)                          â”‚
â”‚  - How many requests per second?                            â”‚
â”‚  - How much data stored?                                    â”‚
â”‚  - Growth rate?                                             â”‚
â”‚                                                              â”‚
â”‚  2. PERFORMANCE                                             â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                              â”‚
â”‚  - Latency requirements? (p50, p99)                         â”‚
â”‚  - Throughput requirements?                                 â”‚
â”‚  - Real-time or batch processing?                           â”‚
â”‚                                                              â”‚
â”‚  3. AVAILABILITY                                            â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                             â”‚
â”‚  - What's acceptable downtime?                              â”‚
â”‚  - 99.9%? 99.99%?                                          â”‚
â”‚  - Single region or multi-region?                           â”‚
â”‚                                                              â”‚
â”‚  4. CONSISTENCY                                             â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                              â”‚
â”‚  - Strong consistency required?                             â”‚
â”‚  - Eventual consistency acceptable?                         â”‚
â”‚  - What are the consistency boundaries?                     â”‚
â”‚                                                              â”‚
â”‚  5. DURABILITY                                              â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                               â”‚
â”‚  - Can we lose data?                                        â”‚
â”‚  - Backup requirements?                                     â”‚
â”‚  - Disaster recovery?                                       â”‚
â”‚                                                              â”‚
â”‚  6. SECURITY                                                â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                 â”‚
â”‚  - Authentication method?                                   â”‚
â”‚  - Encryption requirements?                                 â”‚
â”‚  - Compliance (GDPR, HIPAA)?                               â”‚
â”‚                                                              â”‚
â”‚                                                              â”‚
â”‚  Example: Design Twitter                                    â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                     â”‚
â”‚  Scale: 500M users, 100K tweets/sec read, 10K tweets/sec    â”‚
â”‚  Performance: Timeline load < 200ms p99                     â”‚
â”‚  Availability: 99.99% (52 min downtime/year)               â”‚
â”‚  Consistency: Eventual (tweets can take seconds to appear)  â”‚
â”‚                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

```python
# requirements_template.py
from dataclasses import dataclass, field
from typing import List, Optional
from enum import Enum

class ConsistencyLevel(Enum):
    STRONG = "strong"
    EVENTUAL = "eventual"
    CAUSAL = "causal"

@dataclass
class FunctionalRequirements:
    """Template for capturing functional requirements"""
    
    # Core features (must have)
    core_features: List[str] = field(default_factory=list)
    
    # Nice to have features
    optional_features: List[str] = field(default_factory=list)
    
    # Explicitly out of scope
    out_of_scope: List[str] = field(default_factory=list)
    
    # User types
    user_types: List[str] = field(default_factory=list)
    
    # Input types
    inputs: List[str] = field(default_factory=list)
    
    # Output types
    outputs: List[str] = field(default_factory=list)

@dataclass
class NonFunctionalRequirements:
    """Template for capturing non-functional requirements"""
    
    # Scale
    total_users: int = 0
    daily_active_users: int = 0
    requests_per_second_read: int = 0
    requests_per_second_write: int = 0
    data_size_gb: int = 0
    growth_rate_percent_yearly: int = 0
    
    # Performance
    latency_p50_ms: int = 100
    latency_p99_ms: int = 500
    throughput_required: int = 0
    
    # Availability
    availability_percent: float = 99.9
    multi_region: bool = False
    
    # Consistency
    consistency_level: ConsistencyLevel = ConsistencyLevel.EVENTUAL
    
    # Other
    security_requirements: List[str] = field(default_factory=list)
    compliance_requirements: List[str] = field(default_factory=list)

# Example: Twitter-like system
twitter_functional = FunctionalRequirements(
    core_features=[
        "Post tweets (280 chars max, with media)",
        "Follow/unfollow users",
        "View home timeline",
        "View user timeline",
        "Like tweets",
        "Retweet",
    ],
    optional_features=[
        "Search tweets",
        "Hashtags",
        "Notifications",
    ],
    out_of_scope=[
        "Direct messages",
        "Trending topics",
        "Ads platform",
        "Analytics dashboard",
    ],
    user_types=["Regular user", "Verified user", "Admin"],
    inputs=["Text", "Images", "Videos"],
    outputs=["Timeline feed", "User profiles", "Notifications"]
)

twitter_nfr = NonFunctionalRequirements(
    total_users=500_000_000,
    daily_active_users=200_000_000,
    requests_per_second_read=100_000,
    requests_per_second_write=10_000,
    data_size_gb=1_000_000,  # 1 PB
    growth_rate_percent_yearly=20,
    latency_p50_ms=50,
    latency_p99_ms=200,
    availability_percent=99.99,
    multi_region=True,
    consistency_level=ConsistencyLevel.EVENTUAL,
    security_requirements=["OAuth 2.0", "HTTPS", "Rate limiting"],
    compliance_requirements=["GDPR", "CCPA"]
)
```

---

## 20.3 Back-of-Envelope Estimation

### 20.3.1 Numbers to Memorize

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           NUMBERS EVERY ENGINEER SHOULD KNOW                 â”‚
â”‚                                                              â”‚
â”‚  TIME CONVERSIONS                                           â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                          â”‚
â”‚  1 day    = 86,400 seconds â‰ˆ 100,000 seconds               â”‚
â”‚  1 week   = 604,800 seconds â‰ˆ 600,000 seconds              â”‚
â”‚  1 month  = 2.6M seconds â‰ˆ 2.5M seconds                    â”‚
â”‚  1 year   = 31.5M seconds â‰ˆ 30M seconds                    â”‚
â”‚                                                              â”‚
â”‚  QUICK CONVERSIONS                                          â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                          â”‚
â”‚  1M requests/day = ~12 requests/second                      â”‚
â”‚  1B requests/day = ~12,000 requests/second                  â”‚
â”‚  100K requests/day = ~1 request/second                      â”‚
â”‚                                                              â”‚
â”‚                                                              â”‚
â”‚  DATA SIZE                                                  â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                  â”‚
â”‚  1 character = 1 byte (ASCII) or 2-4 bytes (UTF-8)         â”‚
â”‚  1 integer   = 4 bytes (32-bit) or 8 bytes (64-bit)        â”‚
â”‚  1 UUID      = 16 bytes (128-bit)                          â”‚
â”‚  1 timestamp = 8 bytes                                      â”‚
â”‚                                                              â”‚
â”‚  TYPICAL SIZES                                              â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                              â”‚
â”‚  Tweet (280 chars)           = ~500 bytes (with metadata)   â”‚
â”‚  User profile                = ~1 KB                        â”‚
â”‚  Image thumbnail             = ~20 KB                       â”‚
â”‚  Image (compressed)          = ~200 KB                      â”‚
â”‚  Image (high-res)            = ~2 MB                        â”‚
â”‚  1 min video (compressed)    = ~10 MB                       â”‚
â”‚  1 min video (HD)            = ~100 MB                      â”‚
â”‚                                                              â”‚
â”‚                                                              â”‚
â”‚  STORAGE UNITS                                              â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                              â”‚
â”‚  1 KB = 1,000 bytes â‰ˆ 1,000 bytes                         â”‚
â”‚  1 MB = 1,000 KB â‰ˆ 1 million bytes                        â”‚
â”‚  1 GB = 1,000 MB â‰ˆ 1 billion bytes                        â”‚
â”‚  1 TB = 1,000 GB â‰ˆ 1 trillion bytes                       â”‚
â”‚  1 PB = 1,000 TB                                           â”‚
â”‚                                                              â”‚
â”‚                                                              â”‚
â”‚  NETWORK LATENCY                                            â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                            â”‚
â”‚  Same datacenter RTT:     ~0.5 ms                          â”‚
â”‚  Same region RTT:         ~5 ms                             â”‚
â”‚  Cross-country RTT:       ~50 ms                            â”‚
â”‚  Cross-continent RTT:     ~150 ms                           â”‚
â”‚  Satellite RTT:           ~600 ms                           â”‚
â”‚                                                              â”‚
â”‚                                                              â”‚
â”‚  DATABASE PERFORMANCE (approximate)                         â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                         â”‚
â”‚  Redis read:              < 1 ms                            â”‚
â”‚  Redis write:             < 1 ms                            â”‚
â”‚  PostgreSQL read (indexed): 1-5 ms                          â”‚
â”‚  PostgreSQL write:        5-20 ms                           â”‚
â”‚  S3 read:                 50-100 ms                         â”‚
â”‚                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 20.3.2 Estimation Calculator

```python
# estimation_calculator.py
from dataclasses import dataclass
from typing import Optional
import math

@dataclass
class SystemEstimates:
    """Calculate system resource estimates"""
    
    # Input parameters
    total_users: int
    daily_active_users: int
    
    # Per-user activity (per day)
    reads_per_user_per_day: int
    writes_per_user_per_day: int
    
    # Data sizes
    avg_record_size_bytes: int
    
    # Time parameters
    peak_to_average_ratio: float = 3.0  # Peak is 3x average
    
    def __post_init__(self):
        self._calculate()
    
    def _calculate(self):
        """Calculate all estimates"""
        # Daily totals
        self.daily_reads = self.daily_active_users * self.reads_per_user_per_day
        self.daily_writes = self.daily_active_users * self.writes_per_user_per_day
        
        # Per-second (average)
        seconds_per_day = 86400
        self.avg_reads_per_second = self.daily_reads / seconds_per_day
        self.avg_writes_per_second = self.daily_writes / seconds_per_day
        
        # Per-second (peak)
        self.peak_reads_per_second = self.avg_reads_per_second * self.peak_to_average_ratio
        self.peak_writes_per_second = self.avg_writes_per_second * self.peak_to_average_ratio
        
        # Storage (daily growth)
        self.daily_storage_bytes = self.daily_writes * self.avg_record_size_bytes
        self.daily_storage_gb = self.daily_storage_bytes / (1024 ** 3)
        
        # Storage (yearly)
        self.yearly_storage_gb = self.daily_storage_gb * 365
        self.yearly_storage_tb = self.yearly_storage_gb / 1024
        
        # Bandwidth
        self.avg_bandwidth_mbps = (
            self.avg_reads_per_second * self.avg_record_size_bytes * 8
        ) / (1024 * 1024)
        
        self.peak_bandwidth_mbps = self.avg_bandwidth_mbps * self.peak_to_average_ratio
    
    def print_summary(self):
        """Print formatted summary"""
        print("=" * 60)
        print("SYSTEM ESTIMATES")
        print("=" * 60)
        
        print(f"\nğŸ“Š TRAFFIC")
        print(f"   Daily reads:  {self.daily_reads:,.0f}")
        print(f"   Daily writes: {self.daily_writes:,.0f}")
        print(f"   Avg reads/sec:  {self.avg_reads_per_second:,.1f}")
        print(f"   Avg writes/sec: {self.avg_writes_per_second:,.1f}")
        print(f"   Peak reads/sec:  {self.peak_reads_per_second:,.1f}")
        print(f"   Peak writes/sec: {self.peak_writes_per_second:,.1f}")
        
        print(f"\nğŸ’¾ STORAGE")
        print(f"   Daily growth: {self.daily_storage_gb:,.2f} GB")
        print(f"   Yearly growth: {self.yearly_storage_tb:,.2f} TB")
        
        print(f"\nğŸŒ BANDWIDTH")
        print(f"   Avg: {self.avg_bandwidth_mbps:,.1f} Mbps")
        print(f"   Peak: {self.peak_bandwidth_mbps:,.1f} Mbps")

def estimate_twitter():
    """Example: Twitter estimation"""
    estimates = SystemEstimates(
        total_users=500_000_000,
        daily_active_users=200_000_000,
        reads_per_user_per_day=100,  # View 100 tweets
        writes_per_user_per_day=1,   # Post 1 tweet
        avg_record_size_bytes=500,   # ~500 bytes per tweet
    )
    
    print("\nğŸ“± TWITTER ESTIMATES")
    estimates.print_summary()
    
    # Additional Twitter-specific calculations
    print(f"\nğŸ“ˆ TIMELINE FANOUT")
    avg_followers = 200
    celebrity_followers = 10_000_000
    tweets_per_second = estimates.avg_writes_per_second
    
    # Fanout writes for timeline delivery
    fanout_writes = tweets_per_second * avg_followers
    print(f"   Timeline fanout (avg user): {fanout_writes:,.0f} writes/sec")
    
    # Celebrity problem
    celebrity_tweets_per_second = 100  # Assume 100 celebrity tweets/sec
    celebrity_fanout = celebrity_tweets_per_second * celebrity_followers
    print(f"   Celebrity fanout: {celebrity_fanout:,.0f} writes/sec (HUGE!)")
    print(f"   Solution: Pull model for celebrities, push for regular users")

def estimate_url_shortener():
    """Example: URL Shortener estimation"""
    estimates = SystemEstimates(
        total_users=100_000_000,
        daily_active_users=10_000_000,
        reads_per_user_per_day=10,   # 10 redirects per user
        writes_per_user_per_day=0.1,  # 1 URL per 10 days
        avg_record_size_bytes=200,   # short URL + long URL + metadata
    )
    
    print("\nğŸ”— URL SHORTENER ESTIMATES")
    estimates.print_summary()
    
    # URL shortening specific
    print(f"\nğŸ”‘ KEY SPACE")
    chars = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789"
    key_length = 7
    possible_keys = len(chars) ** key_length
    print(f"   {key_length} char key with {len(chars)} chars = {possible_keys:,.0f} possible keys")
    
    years_of_urls = 10
    total_urls = estimates.daily_writes * 365 * years_of_urls
    print(f"   URLs in {years_of_urls} years: {total_urls:,.0f}")
    print(f"   Key space utilization: {total_urls/possible_keys*100:.4f}%")

def estimate_chat_system():
    """Example: Chat system estimation"""
    estimates = SystemEstimates(
        total_users=100_000_000,
        daily_active_users=50_000_000,
        reads_per_user_per_day=500,  # Read many messages
        writes_per_user_per_day=50,   # Send 50 messages
        avg_record_size_bytes=200,    # Message with metadata
    )
    
    print("\nğŸ’¬ CHAT SYSTEM ESTIMATES")
    estimates.print_summary()
    
    # Chat specific
    print(f"\nğŸ”Œ WEBSOCKET CONNECTIONS")
    concurrent_users = estimates.daily_active_users * 0.1  # 10% concurrent
    print(f"   Concurrent users: {concurrent_users:,.0f}")
    connections_per_server = 50_000  # Typical WebSocket server capacity
    servers_needed = math.ceil(concurrent_users / connections_per_server)
    print(f"   WebSocket servers needed: {servers_needed}")

# Run examples
if __name__ == "__main__":
    estimate_twitter()
    estimate_url_shortener()
    estimate_chat_system()
```

---

## 20.4 High-Level Design Patterns

### 20.4.1 Common Architecture Patterns

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          COMMON HIGH-LEVEL ARCHITECTURES                     â”‚
â”‚                                                              â”‚
â”‚                                                              â”‚
â”‚  PATTERN 1: Basic Web Application                           â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                          â”‚
â”‚                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Client â”‚â”€â”€â”€â–¶â”‚   LB    â”‚â”€â”€â”€â–¶â”‚   API    â”‚â”€â”€â”€â–¶â”‚   DB   â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚ Servers  â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                               â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚
â”‚                                                              â”‚
â”‚  Use for: Simple CRUD apps, MVPs, small scale              â”‚
â”‚                                                              â”‚
â”‚                                                              â”‚
â”‚  PATTERN 2: With Caching                                    â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                   â”‚
â”‚                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”‚
â”‚  â”‚ Client â”‚â”€â”€â”€â–¶â”‚   CDN   â”‚    â”‚   API    â”‚                 â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚ Servers  â”‚                 â”‚
â”‚                    â”‚          â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜                  â”‚
â”‚                    â”‚               â”‚                         â”‚
â”‚                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                         â”‚
â”‚                               â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”                  â”‚
â”‚                               â”‚  Cache   â”‚                  â”‚
â”‚                               â”‚ (Redis)  â”‚                  â”‚
â”‚                               â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜                  â”‚
â”‚                                    â”‚                         â”‚
â”‚                               â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”                  â”‚
â”‚                               â”‚    DB    â”‚                  â”‚
â”‚                               â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚
â”‚                                                              â”‚
â”‚  Use for: Read-heavy workloads, content sites              â”‚
â”‚                                                              â”‚
â”‚                                                              â”‚
â”‚  PATTERN 3: Microservices                                   â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                   â”‚
â”‚                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Client â”‚â”€â”€â”€â–¶â”‚   API   â”‚â”€â”€â”€â–¶â”‚      Service Mesh       â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚ Gateway â”‚    â”‚  â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”â”‚  â”‚
â”‚                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚  â”‚User â”‚ â”‚Orderâ”‚ â”‚Pay  â”‚â”‚  â”‚
â”‚                               â”‚  â”‚Svc  â”‚ â”‚Svc  â”‚ â”‚Svc  â”‚â”‚  â”‚
â”‚                               â”‚  â””â”€â”€â”¬â”€â”€â”˜ â””â”€â”€â”¬â”€â”€â”˜ â””â”€â”€â”¬â”€â”€â”˜â”‚  â”‚
â”‚                               â”‚     â”‚       â”‚       â”‚    â”‚  â”‚
â”‚                               â”‚  â”Œâ”€â”€â”´â”€â”€â” â”Œâ”€â”€â”´â”€â”€â” â”Œâ”€â”€â”´â”€â”€â”â”‚  â”‚
â”‚                               â”‚  â”‚ DB  â”‚ â”‚ DB  â”‚ â”‚ DB  â”‚â”‚  â”‚
â”‚                               â”‚  â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜â”‚  â”‚
â”‚                               â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                              â”‚
â”‚  Use for: Large teams, independent scaling, complex domains â”‚
â”‚                                                              â”‚
â”‚                                                              â”‚
â”‚  PATTERN 4: Event-Driven                                    â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                    â”‚
â”‚                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Client â”‚â”€â”€â”€â–¶â”‚   API   â”‚â”€â”€â”€â–¶â”‚     Message Queue       â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚        (Kafka)          â”‚  â”‚
â”‚                               â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚                                    â–¼       â–¼       â–¼        â”‚
â”‚                               â”Œâ”€â”€â”€â”€â”€â”€â”€â”â”Œâ”€â”€â”€â”€â”€â”€â”€â”â”Œâ”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚                               â”‚Worker1â”‚â”‚Worker2â”‚â”‚Worker3â”‚  â”‚
â”‚                               â””â”€â”€â”€â”€â”€â”€â”€â”˜â””â”€â”€â”€â”€â”€â”€â”€â”˜â””â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                              â”‚
â”‚  Use for: Async processing, decoupled systems, high volume â”‚
â”‚                                                              â”‚
â”‚                                                              â”‚
â”‚  PATTERN 5: CQRS (Command Query Responsibility Segregation) â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
â”‚                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”                                                 â”‚
â”‚  â”‚ Client â”‚                                                 â”‚
â”‚  â””â”€â”€â”€â”¬â”€â”€â”€â”€â”˜                                                 â”‚
â”‚      â”‚                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”´â”€â”€â”€â”                                                  â”‚
â”‚  â”‚       â”‚                                                   â”‚
â”‚  â–¼       â–¼                                                   â”‚
â”‚ Writes  Reads                                               â”‚
â”‚  â”‚       â”‚                                                   â”‚
â”‚  â–¼       â–¼                                                   â”‚
â”‚ â”Œâ”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”                                           â”‚
â”‚ â”‚DB â”‚â”€â”€â”‚Event  â”‚â”€â”€â–¶ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                          â”‚
â”‚ â””â”€â”€â”€â”˜  â”‚Stream â”‚    â”‚Read Model â”‚â—€â”€â”€ Reads                 â”‚
â”‚        â””â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚(optimized)â”‚                          â”‚
â”‚                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                          â”‚
â”‚                                                              â”‚
â”‚  Use for: Different read/write patterns, high read scale   â”‚
â”‚                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 20.4.2 Component Selection Guide

```python
# component_selection.py
"""
Guide for selecting components based on requirements.
"""

from dataclasses import dataclass
from typing import List, Dict
from enum import Enum

class DatabaseType(Enum):
    RELATIONAL = "relational"
    DOCUMENT = "document"
    KEY_VALUE = "key_value"
    WIDE_COLUMN = "wide_column"
    GRAPH = "graph"
    TIME_SERIES = "time_series"

class MessageQueueType(Enum):
    TRADITIONAL = "traditional"  # RabbitMQ
    LOG_BASED = "log_based"      # Kafka
    SIMPLE = "simple"            # SQS, Redis

@dataclass
class ComponentRecommendation:
    component: str
    options: List[str]
    reasoning: str

def select_database(
    data_structure: str,
    consistency_needed: bool,
    scale: str,
    query_patterns: List[str]
) -> ComponentRecommendation:
    """
    Select appropriate database based on requirements.
    """
    
    # Structured data with relationships
    if data_structure == "structured" and "joins" in query_patterns:
        if scale == "small":
            return ComponentRecommendation(
                component="database",
                options=["PostgreSQL", "MySQL"],
                reasoning="Structured data with joins â†’ Relational DB"
            )
        else:
            return ComponentRecommendation(
                component="database",
                options=["CockroachDB", "Vitess", "Citus"],
                reasoning="Large scale structured data â†’ Distributed SQL"
            )
    
    # Document/JSON data
    if data_structure == "document":
        return ComponentRecommendation(
            component="database",
            options=["MongoDB", "DynamoDB", "Firestore"],
            reasoning="Flexible schema, document queries â†’ Document DB"
        )
    
    # Simple key-value lookups
    if "simple_lookup" in query_patterns:
        return ComponentRecommendation(
            component="database",
            options=["Redis", "Memcached", "DynamoDB"],
            reasoning="Simple K/V access â†’ Key-Value store"
        )
    
    # Time series data
    if data_structure == "time_series":
        return ComponentRecommendation(
            component="database",
            options=["InfluxDB", "TimescaleDB", "ClickHouse"],
            reasoning="Time-based queries â†’ Time Series DB"
        )
    
    # Graph relationships
    if "graph_traversal" in query_patterns:
        return ComponentRecommendation(
            component="database",
            options=["Neo4j", "Amazon Neptune", "JanusGraph"],
            reasoning="Complex relationships â†’ Graph DB"
        )
    
    # Default
    return ComponentRecommendation(
        component="database",
        options=["PostgreSQL"],
        reasoning="General purpose â†’ PostgreSQL"
    )

def select_cache(
    data_type: str,
    access_pattern: str,
    size_gb: int
) -> ComponentRecommendation:
    """
    Select appropriate caching solution.
    """
    
    if access_pattern == "session":
        return ComponentRecommendation(
            component="cache",
            options=["Redis"],
            reasoning="Session data â†’ Redis (TTL support, persistence)"
        )
    
    if data_type == "static_content":
        return ComponentRecommendation(
            component="cache",
            options=["CDN (CloudFront, Fastly)", "Varnish"],
            reasoning="Static content â†’ CDN at edge"
        )
    
    if size_gb > 100:
        return ComponentRecommendation(
            component="cache",
            options=["Redis Cluster", "Memcached"],
            reasoning="Large cache â†’ Distributed cache"
        )
    
    return ComponentRecommendation(
        component="cache",
        options=["Redis", "Memcached"],
        reasoning="General caching â†’ Redis (more features) or Memcached (simpler)"
    )

def select_message_queue(
    ordering_required: bool,
    replay_needed: bool,
    throughput: str,
    use_case: str
) -> ComponentRecommendation:
    """
    Select appropriate message queue.
    """
    
    if replay_needed or use_case == "event_sourcing":
        return ComponentRecommendation(
            component="message_queue",
            options=["Apache Kafka", "Amazon Kinesis", "Pulsar"],
            reasoning="Replay/event sourcing â†’ Log-based queue"
        )
    
    if use_case == "task_queue":
        return ComponentRecommendation(
            component="message_queue",
            options=["Celery + Redis", "RabbitMQ", "Amazon SQS"],
            reasoning="Background tasks â†’ Traditional queue"
        )
    
    if throughput == "extreme":
        return ComponentRecommendation(
            component="message_queue",
            options=["Apache Kafka", "Pulsar"],
            reasoning="Extreme throughput â†’ Kafka/Pulsar"
        )
    
    if ordering_required:
        return ComponentRecommendation(
            component="message_queue",
            options=["Kafka", "SQS FIFO", "RabbitMQ"],
            reasoning="Ordering required â†’ FIFO-capable queue"
        )
    
    return ComponentRecommendation(
        component="message_queue",
        options=["RabbitMQ", "Amazon SQS"],
        reasoning="General messaging â†’ RabbitMQ or SQS"
    )

# Example usage
def design_twitter_components():
    """Example: Select components for Twitter-like system"""
    
    print("ğŸ¦ TWITTER COMPONENT SELECTION")
    print("=" * 50)
    
    # Timeline storage
    timeline_db = select_database(
        data_structure="structured",
        consistency_needed=False,
        scale="large",
        query_patterns=["range_scan", "time_ordered"]
    )
    print(f"\nğŸ“Š Timeline Storage:")
    print(f"   Options: {timeline_db.options}")
    print(f"   Reasoning: {timeline_db.reasoning}")
    
    # User data
    user_db = select_database(
        data_structure="structured",
        consistency_needed=True,
        scale="medium",
        query_patterns=["joins", "simple_lookup"]
    )
    print(f"\nğŸ‘¤ User Storage:")
    print(f"   Options: {user_db.options}")
    print(f"   Reasoning: {user_db.reasoning}")
    
    # Cache
    cache = select_cache(
        data_type="user_content",
        access_pattern="read_heavy",
        size_gb=50
    )
    print(f"\nğŸ’¾ Cache:")
    print(f"   Options: {cache.options}")
    print(f"   Reasoning: {cache.reasoning}")
    
    # Message queue for fanout
    mq = select_message_queue(
        ordering_required=True,
        replay_needed=True,
        throughput="extreme",
        use_case="event_stream"
    )
    print(f"\nğŸ“¬ Message Queue:")
    print(f"   Options: {mq.options}")
    print(f"   Reasoning: {mq.reasoning}")

# design_twitter_components()
```

---

## 20.5 API Design

### 20.5.1 RESTful API Design

```python
# api_design_template.py
"""
API design templates and best practices.
"""

from fastapi import FastAPI, HTTPException, Query, Path, Header
from pydantic import BaseModel, Field
from typing import List, Optional
from datetime import datetime
from enum import Enum

app = FastAPI(
    title="Twitter Clone API",
    description="API for a Twitter-like social platform",
    version="1.0.0"
)

# ============== MODELS ==============

class TweetCreate(BaseModel):
    """Create a new tweet"""
    content: str = Field(..., max_length=280, description="Tweet content")
    media_ids: Optional[List[str]] = Field(None, description="Attached media IDs")
    reply_to_id: Optional[str] = Field(None, description="ID of tweet being replied to")

class Tweet(BaseModel):
    """Tweet response model"""
    id: str
    user_id: str
    content: str
    created_at: datetime
    like_count: int = 0
    retweet_count: int = 0
    reply_count: int = 0
    media_urls: List[str] = []

class PaginatedResponse(BaseModel):
    """Standard paginated response"""
    items: List[Tweet]
    next_cursor: Optional[str] = None
    has_more: bool = False

class TimelineType(str, Enum):
    HOME = "home"
    USER = "user"
    MENTIONS = "mentions"

# ============== TWEETS API ==============

@app.post(
    "/api/v1/tweets",
    response_model=Tweet,
    status_code=201,
    summary="Create a new tweet",
    tags=["Tweets"]
)
async def create_tweet(
    tweet: TweetCreate,
    authorization: str = Header(..., description="Bearer token")
):
    """
    Create a new tweet.
    
    - **content**: Tweet text (max 280 characters)
    - **media_ids**: Optional list of uploaded media IDs
    - **reply_to_id**: If replying to another tweet
    
    Returns the created tweet.
    """
    # Implementation
    pass

@app.get(
    "/api/v1/tweets/{tweet_id}",
    response_model=Tweet,
    summary="Get a tweet by ID",
    tags=["Tweets"]
)
async def get_tweet(
    tweet_id: str = Path(..., description="Tweet ID")
):
    """Get a single tweet by its ID."""
    pass

@app.delete(
    "/api/v1/tweets/{tweet_id}",
    status_code=204,
    summary="Delete a tweet",
    tags=["Tweets"]
)
async def delete_tweet(
    tweet_id: str = Path(..., description="Tweet ID"),
    authorization: str = Header(...)
):
    """Delete a tweet. Only the author can delete their tweets."""
    pass

# ============== TIMELINE API ==============

@app.get(
    "/api/v1/timeline/{timeline_type}",
    response_model=PaginatedResponse,
    summary="Get timeline",
    tags=["Timeline"]
)
async def get_timeline(
    timeline_type: TimelineType,
    cursor: Optional[str] = Query(None, description="Pagination cursor"),
    limit: int = Query(20, ge=1, le=100, description="Items per page"),
    authorization: str = Header(...)
):
    """
    Get user's timeline.
    
    - **home**: Tweets from followed users
    - **user**: User's own tweets
    - **mentions**: Tweets mentioning the user
    
    Uses cursor-based pagination for efficiency.
    """
    pass

# ============== USERS API ==============

@app.get(
    "/api/v1/users/{user_id}",
    summary="Get user profile",
    tags=["Users"]
)
async def get_user(user_id: str):
    """Get user profile by ID."""
    pass

@app.post(
    "/api/v1/users/{user_id}/follow",
    status_code=204,
    summary="Follow a user",
    tags=["Users"]
)
async def follow_user(
    user_id: str,
    authorization: str = Header(...)
):
    """Follow another user."""
    pass

@app.delete(
    "/api/v1/users/{user_id}/follow",
    status_code=204,
    summary="Unfollow a user",
    tags=["Users"]
)
async def unfollow_user(
    user_id: str,
    authorization: str = Header(...)
):
    """Unfollow a user."""
    pass

@app.get(
    "/api/v1/users/{user_id}/followers",
    response_model=PaginatedResponse,
    summary="Get user's followers",
    tags=["Users"]
)
async def get_followers(
    user_id: str,
    cursor: Optional[str] = Query(None),
    limit: int = Query(20, ge=1, le=100)
):
    """Get list of users following this user."""
    pass

# ============== INTERACTIONS API ==============

@app.post(
    "/api/v1/tweets/{tweet_id}/like",
    status_code=204,
    summary="Like a tweet",
    tags=["Interactions"]
)
async def like_tweet(
    tweet_id: str,
    authorization: str = Header(...)
):
    """Like a tweet. Idempotent - liking twice has no additional effect."""
    pass

@app.delete(
    "/api/v1/tweets/{tweet_id}/like",
    status_code=204,
    summary="Unlike a tweet",
    tags=["Interactions"]
)
async def unlike_tweet(
    tweet_id: str,
    authorization: str = Header(...)
):
    """Remove like from a tweet."""
    pass

@app.post(
    "/api/v1/tweets/{tweet_id}/retweet",
    response_model=Tweet,
    status_code=201,
    summary="Retweet",
    tags=["Interactions"]
)
async def retweet(
    tweet_id: str,
    authorization: str = Header(...)
):
    """Retweet a tweet. Creates a new tweet referencing the original."""
    pass
```

---

## 20.6 Interview Time Management

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         SYSTEM DESIGN INTERVIEW TIME MANAGEMENT              â”‚
â”‚                                                              â”‚
â”‚  Total Time: 45 minutes                                     â”‚
â”‚                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ 0-5 min   â”‚ REQUIREMENTS                            â”‚   â”‚
â”‚  â”‚           â”‚ - Clarify scope                         â”‚   â”‚
â”‚  â”‚           â”‚ - Ask questions                         â”‚   â”‚
â”‚  â”‚           â”‚ - Define constraints                    â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ 5-10 min  â”‚ ESTIMATION                              â”‚   â”‚
â”‚  â”‚           â”‚ - Calculate scale                       â”‚   â”‚
â”‚  â”‚           â”‚ - Storage needs                         â”‚   â”‚
â”‚  â”‚           â”‚ - Bandwidth requirements                â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ 10-25 min â”‚ HIGH-LEVEL DESIGN                       â”‚   â”‚
â”‚  â”‚           â”‚ - Draw component diagram                â”‚   â”‚
â”‚  â”‚           â”‚ - Explain data flow                     â”‚   â”‚
â”‚  â”‚           â”‚ - Justify component choices             â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ 25-40 min â”‚ DETAILED DESIGN                         â”‚   â”‚
â”‚  â”‚           â”‚ - Deep dive 2-3 components              â”‚   â”‚
â”‚  â”‚           â”‚ - Data model / API design               â”‚   â”‚
â”‚  â”‚           â”‚ - Handle edge cases                     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ 40-45 min â”‚ WRAP-UP                                 â”‚   â”‚
â”‚  â”‚           â”‚ - Discuss trade-offs                    â”‚   â”‚
â”‚  â”‚           â”‚ - Scaling strategies                    â”‚   â”‚
â”‚  â”‚           â”‚ - Answer remaining questions            â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                              â”‚
â”‚  KEY TIPS:                                                  â”‚
â”‚  - Drive the conversation (don't wait for interviewer)      â”‚
â”‚  - Think out loud (show your reasoning)                     â”‚
â”‚  - Start simple, then add complexity                        â”‚
â”‚  - Ask "Is this the right direction?" periodically          â”‚
â”‚  - It's okay to not cover everything                        â”‚
â”‚                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Summary

| Phase | Time | Focus |
|-------|------|-------|
| **Requirements** | 5 min | Scope, constraints, NFRs |
| **Estimation** | 5 min | Scale calculations |
| **High-Level** | 15 min | Architecture diagram |
| **Detailed** | 15 min | Deep dive components |
| **Wrap-up** | 5 min | Trade-offs, scaling |

---

## Practice Exercises

1. Practice RESHADED framework on 5 different problems
2. Memorize key estimation numbers
3. Create component diagrams for common systems
4. Design APIs for Twitter, Instagram, and Uber
5. Practice explaining designs out loud

**Next Chapter**: Deep dive case studies!
